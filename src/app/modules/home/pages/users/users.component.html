<div class="w-full h-full flex p-8 flex-col gap-8">
  <div class="w-full flex justify-between">
    <div class="text-slate-500 font-bold text-xl">
      <span>Usuarios</span>
    </div>
    <div>
      <button (click)="onCreateUser()"
              class="flex items-center justify-center capitalize px-5 py-2 text-sm text-gray-500 transition-colors duration-200 bg-white border rounded-md gap-x-2 hover:bg-gray-100">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 512 512">
          <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                stroke-width="32" d="M256 112v288M400 256H112"/>
        </svg>
        Crear usuario
      </button>
    </div>
  </div>
  <section class="container mx-auto space-y-4">
    <div class="mt-6 flex justify-end">
      <div class="inline-flex overflow-hidden bg-white divide-x rounded-lg rtl:flex-row-reverse">
        <input type="text" class="w-full px-4 py-2 text-sm text-gray-900 placeholder-gray-500 focus:outline-none"
               placeholder="Buscar usuario"/>
        <button
          class="flex items-center justify-center px-4 text-gray-500 bg-gray-100 hover:bg-gray-200 focus:outline-none">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="flex flex-col">
      <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
        <div class="inline-block min-w-full py-2 align-middle md:px-6 lg:px-8">
          <div class="overflow-hidden border border-gray-200 md:rounded-lg">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="py-3.5 px-4 text-sm font-normal text-center rtl:text-right text-gray-500">
                  <button class="flex items-center gap-x-3 focus:outline-none">
                    <span>Nombres</span>

                    <svg class="h-3" viewBox="0 0 10 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M2.13347 0.0999756H2.98516L5.01902 4.79058H3.86226L3.45549 3.79907H1.63772L1.24366 4.79058H0.0996094L2.13347 0.0999756ZM2.54025 1.46012L1.96822 2.92196H3.11227L2.54025 1.46012Z"
                        fill="currentColor" stroke="currentColor" stroke-width="0.1"/>
                      <path
                        d="M0.722656 9.60832L3.09974 6.78633H0.811638V5.87109H4.35819V6.78633L2.01925 9.60832H4.43446V10.5617H0.722656V9.60832Z"
                        fill="currentColor" stroke="currentColor" stroke-width="0.1"/>
                      <path
                        d="M8.45558 7.25664V7.40664H8.60558H9.66065C9.72481 7.40664 9.74667 7.42274 9.75141 7.42691C9.75148 7.42808 9.75146 7.42993 9.75116 7.43262C9.75001 7.44265 9.74458 7.46304 9.72525 7.49314C9.72522 7.4932 9.72518 7.49326 9.72514 7.49332L7.86959 10.3529L7.86924 10.3534C7.83227 10.4109 7.79863 10.418 7.78568 10.418C7.77272 10.418 7.73908 10.4109 7.70211 10.3534L7.70177 10.3529L5.84621 7.49332C5.84617 7.49325 5.84612 7.49318 5.84608 7.49311C5.82677 7.46302 5.82135 7.44264 5.8202 7.43262C5.81989 7.42993 5.81987 7.42808 5.81994 7.42691C5.82469 7.42274 5.84655 7.40664 5.91071 7.40664H6.96578H7.11578V7.25664V0.633865C7.11578 0.42434 7.29014 0.249976 7.49967 0.249976H8.07169C8.28121 0.249976 8.45558 0.42434 8.45558 0.633865V7.25664Z"
                        fill="currentColor" stroke="currentColor" stroke-width="0.3"/>
                    </svg>
                  </button>
                </th>

                <th scope="col"
                    class="px-12 py-3.5 text-sm font-normal text-center rtl:text-right text-gray-500">
                  Usuario
                </th>

                <th scope="col"
                    class="px-12 py-3.5 text-sm font-normal text-center rtl:text-right text-gray-500">
                  Email
                </th>

                <th scope="col"
                    class="px-12 py-3.5 text-sm font-normal text-center rtl:text-right text-gray-500">
                  Rol
                </th>
                <th scope="col"
                    class="px-12 py-3.5 text-sm font-normal rtl:text-right text-gray-500 text-center">
                  Estado
                </th>
                <th scope="col"
                    class="px-12 py-3.5 text-sm font-normal text-center rtl:text-right text-gray-500">
                  Acciones
                </th>
              </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200">
                @for (user of users; track users; let i = $index) {
                  <tr>
                    <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                      <div>
                        <h2 class="font-medium text-slate-500">{{ user.full_name }}</h2>
                      </div>
                    </td>
                    <td class="px-4 py-4 text-sm text-center font-medium whitespace-nowrap">
                      <div>
                        <h2 class="font-medium text-slate-500">{{ user.username }}</h2>
                      </div>
                    </td>
                    <td class="px-4 py-4 text-sm text-center font-medium whitespace-nowrap">
                      <div>
                        <h2 class="font-medium text-slate-500">{{ user.email }}</h2>
                      </div>
                    </td>
                    <td class="px-4 py-4 text-sm text-center font-medium whitespace-nowrap">
                      <div>
                        <h2
                          class="inline px-3 py-1 text-sm font-normal select-none rounded-full chip-role-{{user.id_level_user}}">
                          {{ user.id_level_user === 1 ? 'Administrador' : user.id_level_user === 2 ? 'Trabajor' : 'Colaborador' }}
                        </h2>
                      </div>
                    </td>
                    <td class="px-12 py-4 text-sm font-medium whitespace-nowrap">
                      @if (user.status_id === 3) {
                        <div class="flex w-full justify-center">
                          <div
                            class="inline px-3 py-1 text-sm font-normal select-none rounded-full text-emerald-500 gap-x-2 bg-emerald-100/60">
                            Activo
                          </div>
                        </div>
                      } @else {
                        <div class="flex w-full justify-center">
                          <div
                            class="inline px-3 py-1 text-sm font-normal select-none rounded-full text-red-500 gap-x-2 bg-red-100/60">
                            Eliminado
                          </div>
                        </div>
                      }
                    </td>

                    <td class="px-12 py-4 text-sm font-medium whitespace-nowrap flex gap-4 justify-center">
                      <div class="cursor-pointer flex justify-center" title="Eliminar usuario"
                           (click)="deleteModal = true; userSelected = user">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-slate-500" viewBox="0 0 512 512">
                          <path d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320"
                                fill="none"
                                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
                          <path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32"
                                d="M80 112h352"/>
                          <path
                            d="M192 112V72h0a23.93 23.93 0 0124-24h80a23.93 23.93 0 0124 24h0v40M256 176v224M184 176l8 224M328 176l-8 224"
                            fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                            stroke-width="32"/>
                        </svg>
                      </div>
                      <div class="cursor-pointer flex justify-center" (click)="onUpdateUser(user)"
                           title="Editar usuario">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-slate-500" viewBox="0 0 512 512">
                          <path d="M384 224v184a40 40 0 01-40 40H104a40 40 0 01-40-40V168a40 40 0 0140-40h167.48"
                                fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="32"/>
                          <path
                            d="M459.94 53.25a16.06 16.06 0 00-23.22-.56L424.35 65a8 8 0 000 11.31l11.34 11.32a8 8 0 0011.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90L218.82 270.2a9 9 0 00-2.31 3.93L208.16 299a3.91 3.91 0 004.86 4.86l24.85-8.35a9 9 0 003.93-2.31L422 112.66a9 9 0 000-12.66l-9.95-10a9 9 0 00-12.71 0z"/>
                        </svg>
                      </div>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<app-modal [(show)]="showModal" [title]="modalTitle" (onNext)="saveUser()">
  <form class="space-y-4" [formGroup]="formUser">
    <div class="grid grid-cols-2 gap-4 ">
      <div>
        <label for="user" class="block mb-2 text-sm font-medium text-slate-500">Usuario</label>
        <input type="text" name="user" id="user" formControlName="user"
               class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
               required/>
      </div>
      <div>
        <label for="password" class="block mb-2 text-sm font-medium text-slate-500">Contraseña</label>
        <input type="password" name="password" id="password" formControlName="password"
               class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
               required/>
      </div>
    </div>
    <div>
      <label class="block mb-2 text-sm font-medium text-slate-500">Nombres completos</label>
      <input type="text" name="names" id="names" formControlName="name"
             class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
             required/>
    </div>
    <div class="grid grid-cols-2 gap-4 ">
      <div>
        <label for="email" class="block mb-2 text-sm font-medium text-slate-500">Correo electrónico</label>
        <input type="email" name="email" id="email" formControlName="email"
               class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
               required/>
      </div>
      <div>
        <label class="block mb-2 text-sm font-medium text-slate-500">Rol</label>
        <select formControlName="role"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
          <option selected hidden>Seleccione un rol</option>
          <option value="1">Administrador</option>
          <option value="2">Trabajor</option>
          <option value="3">Colaborador</option>
        </select>
      </div>
    </div>
  </form>
</app-modal>

<app-modal [(show)]="deleteModal" [showHeader]="false" buttonSuccess="Aceptar" [showButtonCancel]="true"
           (onNext)="deleteUser()">
  <div class="flex items-center justify-center">
    <svg xmlns="http://www.w3.org/2000/svg" class="w-28 h-28 text-amber-300" viewBox="0 0 512 512">
      <path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none"
            stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>
      <path d="M250.26 166.05L256 288l5.73-121.95a5.74 5.74 0 00-5.79-6h0a5.74 5.74 0 00-5.68 6z" fill="none"
            stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
      <path d="M256 367.91a20 20 0 1120-20 20 20 0 01-20 20z" stroke="currentColor" class="fill-amber-300"/>
    </svg>
  </div>
  <div class="flex justify-center items-center text-slate-500 font-bold text-xl">
    <span>¿Esta seguro de eliminar este usuario?</span>
  </div>
  <div class="text-slate-500 text-sm">
    <span>¡Si realiza esta acción, el usuario no podrá acceder a la plataforma y poder realizar sus actividades!</span>
  </div>
</app-modal>

<app-block-ui [show]="isLoading"></app-block-ui>

<app-toast></app-toast>
